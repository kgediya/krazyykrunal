<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Lensathon Project Showcase</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
        }

        header {
            background-color: #fffc00; /* Snapchat yellow */
            color: #000;
            text-align: center;
            padding: 1em 0;
        }

        #projects-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 20px;
        }

        .project {
            width: 300px;
            margin: 20px;
            padding: 15px;
            background-color: #fffc00; /* Snapchat yellow */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
        }

        video {
            width: 100%;
            height: auto;
        }

        .project-title {
            font-size: 1.2em;
            margin: 10px 0;
            font-weight: bolder;
            color: #000;
        }
        .owner-title {
            font-size: 1em;
            margin: 10px 0;
            font-weight: bold;
            color: #000;
        }

        .project-description {
            color: #333;
        }

        .reactions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        button {
            background-color: #000;
            color: #fffc00; /* Snapchat yellow */
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        button:hover {
            background-color: #333;
        }
    </style>
</head>
<body>
<header>
    <h1>XDG ‡§Æ‡•Å‡§ÇBAI x SnapAR LS 5.0 Beta Mini Lensathon Project Showcase</h1>
    <div id="user-info"></div>
</header>

<div id="projects-container"></div>

<!-- Add the Google Sign-In script -->
<script src="https://apis.google.com/js/platform.js" async defer></script>

<script type="module">
 const allowedEmails = [
  'aadarsh@humanespace.in',
  'aakash.mansukhani@gmail.com',
  'aditya.patel1@aiesec.net',
  'alisha20may@gmail.com',
  'aniketapraj1002@gmail.com',
  'asahebe47@gmail.com',
  'atharv.choughule@gmail.com',
  'bhanpiyaanuraag@gmail.com',
  'biz.shraystha@gmail.com',
  'eshiksha.ai@gmail.com',
  'gauravyadav7403@student.sfit.ac.in',
  'gaurimca2022_19@ncrdsims.edu.in',
  'gnaman719@gmail.com',
  'haziquesayed4@gmail.com',
  'heet01622@gmail.com',
  'jobanputramohan7@gmail.com',
  'kashivaryan54@gmail.com',
  'ksaiansul@gmail.com',
  'kunalrajsingh47@gmail.com',
  'maharanaasish98@gmail.com',
  'manavr472@gmail.com',
  'manavrajpurohit007@gmail.com',
  'manishchaurasia11@gmail.com',
  'manishkumar.pandey@slrtce.in',
  'mansulkar.omkar@gmail.com',
  'nayakmeet0704@gmail.com',
  'pranjalnahata07@gmail.com',
  'prateekarote07@gmail.com',
  'premraval010@outlook.com',
  'prernachavan232@gmail.com',
  'priyanshusondhiya557@gmail.com',
  'purvasha.choudhari@gmail.com',
  'purvikedia20@gmail.com',
  'raj.jaiswar44@gmail.com',
  'rangilamunawwar@gmail.com',
  'ridsid51@gmail.com',
  'rithvikshetty2004@gmail.com',
  'salmaan.bhati@gmail.com',
  'sandeep@augbox.in',
  'saumyasanghvi03@gmail.com',
  'sayyadhani7@gmail.com',
  'shraddhask493@gmail.com',
  'shreyast2003@gmail.com',
  'shubhamnileshpatil@gmail.com',
  'simransankhe4@gmail.com',
  'smkedar30@gmail.com',
  'tanay.khandal02@gmail.com',
  'tesimsodha7046718858@gmail.com',
  'unnati@humanespace.in',
  'vidhi.557777@gmail.com',
  'vinay.somani09@gmail.com',
  'vishal.rt1900@gmail.com',
  'wasimghole97@gmail.com',
  'work.sghike@gmail.com',
  'yashashvidevadiga@gmail.com',
 
];
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js';
    import { getAuth, onAuthStateChanged, signInWithPopup, GoogleAuthProvider } from 'https://www.gstatic.com/firebasejs/9.1.2/firebase-auth.js';
    import { getDatabase, ref, onValue, update, child, set,get } from 'https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js';

    // Initialize Firebase with your project configuration
    const firebaseConfig = {
    apiKey: "AIzaSyCiG3pBNppvdiZUv2nS0Zpmv8kMGRiQGh0",
    authDomain: "xdgm-memorie-wall.firebaseapp.com",
    databaseURL: "https://xdgm-memorie-wall-default-rtdb.firebaseio.com",
    projectId: "xdgm-memorie-wall",
    storageBucket: "xdgm-memorie-wall.appspot.com",
    messagingSenderId: "644674909301",
    appId: "1:644674909301:web:181ac410a2407ab9ddf43c",
    measurementId: "G-ZNPNV3TGMG"
  };

    initializeApp(firebaseConfig);

    const database = getDatabase();

    // Sample data for projects
    const projects = [
        {
            title: 'Christmas Cap',
            project_id:'christmas-cap',
            description: 'CRITSMAS CAP',
            videoUrl: 'https://drive.google.com/uc?id=11eN6-pXSw1dEo-6fA7o8iG3wA_o2Z7ds',
            owner:"heet01622@gmail.com",
            ownerName:"Heet Ruparel"
        },
        {
            title: 'Willy Wonka Scary',
            project_id:'willy-wonka',
            description: 'The lens consist of a default a joker face, when a user smiles the joker face changes to a scary face of a willy wonka type joker.',
            videoUrl: 'https://drive.google.com/uc?id=19v8dji63L1SjEF5_ecNqgtjxXHHjdx2Y',
            owner:"haziquesayed4@gmail.com",
            ownerName:"Mohammed Hazique Sayed"
        },
        {
            title: 'Aqua',
            project_id:'aqua',
            description: "My Snapchat Lens takes you on a vibrant journey through a coral reef, transforming your face into a playful sea creature with interactive bubbles. It's designed for everyone, but especially kids, to learn about ocean life and have fun!",
            videoUrl: 'https://drive.google.com/uc?id=1LWji8aHBYrB-LGzaDn8N1hHkFtj8KWA8',
            owner:"work.sghike@gmail.com",
            ownerName:"Sudhanshu"
        },
        {
            title: 'Glitch me',
            project_id:'glitch-me',
            description: 'Lens created using material graph editor using java script - There are two buttons ( Addition and Subtraction ) FOr adding or subtracting images.',
            videoUrl: 'https://drive.google.com/uc?id=1zSeUIPAwEhtKNPxkgNaekWOpKg2B-dDk',
            owner:"tanay.khandal02@gmail.com",
            ownerName:"Tanay Khandal"
        },
        {
            title: 'Mumbai',
            project_id:'mumbai',
            description: 'I thought to show the beauty of Mumbai City to all the Snapchat users around the world and create an exictment for them to come and travel in Mumbai',
            videoUrl: 'https://drive.google.com/uc?id=1UzmSj78IO2jEGPHF41gYnqEC_jzx62py',
            owner:"shreyast2003@gmail.com",
            ownerName: "Shreyas Thakur"
        },
        {
            title: 'Alam',
            project_id:'alam',
            description: 'Monster flower with Butterfly (NO AI)',
            videoUrl: 'https://drive.google.com/uc?id=1MVna3I09m423zS0EL_mGjx3QkA7soCa9',
            owner:"asahebe47@gmail.com",
            ownerName:"OD Alam"
        },
        {
            title: 'Swag Jutsu',
            project_id:'swag-jutsu',
            description: "Raise your eyebrows and make your rizz stat over 9000 and get all the hot single moms in your area. I wanted to make something funny which anyone can use whenever in any conversation, inspired by kingchris's swag jutsu",
            videoUrl: 'https://drive.google.com/uc?id=16uz-qKnPbkXkjKpaAVgfpTjVOCKyhl4y',
            owner:"shubhamnileshpatil@gmail.com",
            ownerName:"Shubham Patil"
        },
        {
            title: 'Avatar',
            project_id:'avatar',
            description: "I loved the vfx and the character of avatar movie . and I wanted to see myself how I will look if i was a Na'vi .",
            videoUrl: 'https://drive.google.com/uc?id=1sDISIy8fWTl4D2MGwAD7DCE_Hwoj8pDW',
            owner:"vidhi.557777@gmail.com",
            ownerName: "Vidhi Bhanushali"
        },
        {
            title: 'Earth to Mars',
            project_id:'earth-to-mars',
            description: 'Going to Mars from Earth. I thought I would make a informative planet models',
            videoUrl: 'https://drive.google.com/uc?id=1o-y4gs7CYq-folU5qimysxe_BEP6jlRI',
            owner:"manavr472@gmail.com",
            ownerName:"Manav Rajpurohit"
        },
        {
            title: 'Christmas EarringsüéÑ',
            project_id:'christmas-earrings',
            description: "The idea was have a christmas ornament as an earring. Because 'tis the season! I modelled the ornament earring in blender and rigged it. I used PBR generative AI to make the ornament look like a christmas snow globe. I added physics in the lens. Then I added some makeup and snow vfx. Lastly, I used texture generative AI to generate a fun christmas market background behind the user.",
            videoUrl: 'https://drive.google.com/uc?id=11GnqGpub2uaDbA7Gocj93JOzdzvftfAf',
            owner:"unnati@humanespace.in",
            ownerName:"Unnati Israni"
        },
        {
            title: "Apt‚Äôs Space",
            project_id:'apts-space',
            description: "Allows user to dive into celestial live and experience a submersive life of the celestial being, it also depicts a small gesture of having multiple eye sockets which is very adversive.",
            videoUrl: 'https://drive.google.com/uc?id=1_mcl4bnSRQ48nqo7r7e7Ler4sacfyGnX',
            owner:"raj.jaiswar44@gmail.com",
            ownerName:"Raj Jaiswar"
        },
     
        {
            title: 'Sunglasses',
            project_id:'sunglasses',
            description: 'The lens consists of 17 unique and fun sunglasses that a user can tap to change, the sunglasses were designed to be fun and colorful so that children enjoy wearing them. I wanted to create a lens that uses genAI and is also interactive so that LadinAbattle can use this lens to entertain children. ',
            videoUrl: 'https://drive.google.com/uc?id=1JDsdzFOzsa9z4uxiRzn8FYPvaFVtqorq',
            owner:"aakash.mansukhani@gmail.com",
            ownerName:"Aakash Mansukhani"
        },
        {
            title: 'Iron Man',
            project_id:'iron-man',
            description: 'I have used a 3D Model Face Mask and A Hand Tracker. To distract children while getting an injection.',
            videoUrl: 'https://drive.google.com/uc?id=1CpqU_iZxubQkdydFPfNKhSsAviP08FE_',
            owner:"rangilamunawwar@gmail.com",
            ownerName: "Mohammed Munawwar Rangila"
        },
        {
            title: 'Gobwin',
            project_id:'gobwin',
            description: "It's the Gobwin time! Just give me the green already!Green being the money, the user is asking for money this holiday season. The same way I am asking for a cash prize from you guys!",
            videoUrl: 'https://drive.google.com/uc?id=1JzCErtpi67l57zqS-xY90tIQFEsH8Nev',
            owner:"deedlee.do@gmail.com",
            ownerName:"Aadarsh Pandey"
        },
        {
            title: 'Indian Movie',
            project_id:'indian-movie',
            description: "Randomizer to guess current released Indian movies. To catch the trend because this movies are currently trending easy to search by keys",
            videoUrl: 'https://drive.google.com/uc?id=1-gZ4z-QBI4K4KYNh1w-njtc7TfewxIm0',
            owner:"aniketapraj1002@gmail.com",
            ownerName:"Aniket Apraj"
        },
        {
            title: 'Shraddhabkedar',
            project_id:'shraddhabkedar',
            description: 'It is a lens about alien and space',
            videoUrl: 'https://drive.google.com/uc?id=1N2Szl1bevORjpT5DHDrbWQ-FQ6X6kpcb',
            owner:"smkedar30@gmail.com",
            ownerName:"Shraddha Kedar"
        },
        {
            title: 'Shraddha_kadam',
            project_id:'shraddha-kadam',
            description: 'Space related',
            videoUrl: 'https://drive.google.com/uc?id=1QlzvqkTxGqE2GdJCHEFE1GmIhaibHqfr',
            owner:"shraddhask493@gmail.com",
            ownerName:"Shraddha Kadam"
        },
        {
            title: 'Whistle Runner',
            project_id:'whistle-runner',
            description: 'This is a gaming lens that I created which basically is played with the sound microphone captures from your surrounding, please try this lens in a quiet place to work best. Tap to start the game, you can either whistle or make any sound to make the runner jump, users need to avoid the obstacle that is rocks that come in way of the runner and go as long you can, this is an endless game,',
            videoUrl: 'https://drive.google.com/uc?id=1OdaT5cjM_y_qP18WtsjJPOKK6rTQ0S-L',
            owner:"wasimghole97@gmail.com",
            ownerName:"Wasim Ghole"
        },
        {
            title: 'Merry Christmas',
            project_id:'merry-christmas',
            description: 'Experience the holiday cheer with a festive Christmas-themed face mask and jingle bells music in this joyful lens! The approach focused on blending a lively Christmas ambiance with an AI-generated Christmas-themed face mask, aiming to create a fun and engaging lens. By incorporating familiar elements like jingle bells music and traditional Christmas visuals, the goal was to evoke a sense of celebration and delight, offering users a memorable and enjoyable interaction during the festive period.',
            videoUrl: 'https://drive.google.com/uc?id=1r1AZAT-tF7m0ELqc7_cMSFSdHLmz3RcH',
            owner:"premraval010@outlook.com",
            ownerName:"Prem Raval"
        },
      
        {
            title: 'Underwater royal',
            project_id:'underwater-royal',
            description: 'The lens is about how children might feel good experiencing under water experience as a royalty. To make children and people feel like fun.',
            videoUrl: 'https://drive.google.com/uc?id=1tkg_lbxmSAsoAeDL9PZ_3MRW1f6JTpP8',
            owner:"ashishmaharana1998@gmail.com",
            ownerName:"Ashish Mahrana"
        },
        {
            title: 'GenAI Santa',
            project_id:'genai-santa',
            description: 'I was trying to use GenAI to its fullest and only using Lens Studio Resources to its fullest. I wanted to create a small Santa themed lens which is only made with GenAI textures ',
            videoUrl: 'https://drive.google.com/uc?id=1hcsvSU-8bHhuUP-Sf8LqRNVJqM-9Pe60',
            owner:"kunalrajsingh47@gmail.com",
            ownerName:"Kunalraj Singh"
        },
        // Add more projects here
    ];

    const projectsContainer = document.getElementById('projects-container');
const userInfoContainer = document.getElementById('user-info');

// Function to render projects
function renderProjects(user) {
    // Clear existing content
    projectsContainer.innerHTML = '';

    projects.forEach(project => {
        const projectElement = document.createElement('div');
        projectElement.classList.add('project');

        // Using iframe for Google Drive embed
        const videoFrame = document.createElement('iframe');
        videoFrame.src = `https://drive.google.com/file/d/${getDriveFileId(project.videoUrl)}/preview`;
        videoFrame.setAttribute('allowfullscreen', '');

        const titleElement = document.createElement('div');
        titleElement.classList.add('project-title');
        titleElement.textContent = project.title;

        const ownerElement = document.createElement('div');
        ownerElement.classList.add('owner-title');
        ownerElement.textContent = 'By ' + project.ownerName;

        const descriptionElement = document.createElement('div');
        descriptionElement.classList.add('project-description');
        descriptionElement.textContent = project.description;

        const reactionsElement = document.createElement('div');
        reactionsElement.classList.add('reactions');

        projectElement.appendChild(videoFrame); // Append iframe instead of video element
        projectElement.appendChild(titleElement);
        projectElement.appendChild(ownerElement);
        projectElement.appendChild(descriptionElement);
        projectElement.appendChild(reactionsElement);

        projectsContainer.appendChild(projectElement);
    });

    // Render login button or Google Sign-In button
    if (user) {
        userInfoContainer.textContent = `Logged in as: ${user.email}`;
    } else {
        const googleSignInButton = document.createElement('button');
        googleSignInButton.textContent = 'Sign in with Google';
        googleSignInButton.addEventListener('click', signInWithGoogle);
        userInfoContainer.appendChild(googleSignInButton);
    }
}

// Function to extract Google Drive file ID
function getDriveFileId(url) {
    // Example URL format: https://drive.google.com/uc?id=1r1AZAT-tF7m0ELqc7_cMSFSdHLmz3RcH
    const startIndex = url.indexOf('id=') + 3;
    const fileId = url.substring(startIndex);
    return fileId;
}

    // Function to handle voting
    function voteProject(user, projectId, owner) {
    if (!user) {
        alert('Please log in to vote.');
        return;
    }
    if (user && !allowedEmails.includes(user.email)) {
        alert('You are not allowed to vote');
        return;
    }
    if (user && owner === user.email) {
        alert('You cannot vote for your own project');
        return;
    }

    const projectVotesRef = ref(database, `projects/${projectId}/votes`);
    const userVotesRef = ref(database, `projects/${projectId}/voters`);
    const voterlistRef = ref(database, `projects/voterlist`);

    // Check if the user has already voted on another project
    get(voterlistRef)
        .then((voterlistSnapshot) => {
            const voterlist = voterlistSnapshot.val() || {};
            
            if (voterlist[user.uid]) {
                alert('You have already voted for another project.');
            } else {
                // User hasn't voted on another project, proceed to vote for the current project
                const confirmVote = confirm('Once you vote, you cannot vote for any other project. Are you sure you want to vote for this project?');
                
                if (confirmVote) {
                    get(projectVotesRef)
                        .then((snapshot) => {
                            if (snapshot.exists()) {
                                const currentVotes = snapshot.val() || 0;

                             
                                    // Update votes in the database
                                    set(projectVotesRef, currentVotes + 1);
                                    alert('Vote recorded!');
                                    
                                    // Update the voterlist to mark that the user has voted
                                    update(voterlistRef, { [user.uid]: true });
                                
                            } else {
                                // If the project reference doesn't exist, create it and set the initial votes
                                set(projectVotesRef, 1);
                                alert('Vote recorded!');
                                
                                // Update the voterlist to mark that the user has voted
                                update(voterlistRef, { [user.uid]: true });
                            }
                            get(userVotesRef)
                            .then((snapshot)=>{
                                if(snapshot.exists()){
                                    var currentVoters = snapshot.val()||""
                                    set(userVotesRef,currentVoters+", "+user.email)
                                }
                                else{
                                    set(userVotesRef,user.email)
                                }
                            })
                        })
                        .catch((error) => {
                            console.error('Error getting project votes:', error);
                        });
                }
            }
        })
        .catch((error) => {
            console.error('Error getting voterlist:', error);
        });
}
    // Function to check user authentication status
    function checkAuthState() {
        const auth = getAuth();
        onAuthStateChanged(auth, user => {
            userInfoContainer.innerHTML = ''; // Clear existing content
            renderProjects(user);
        });
    }

    // Function to sign in with Google
    function signInWithGoogle() {
        const auth = getAuth();
        const provider = new GoogleAuthProvider();
        signInWithPopup(auth, provider)
            .then(result => {
                const user = result.user;
                userInfoContainer.textContent = `Logged in as: ${user.email}`;
                renderProjects(user);
            })
            .catch(error => {
                console.error(error.message);
                alert('Google Sign-In failed.');
            });
    }

    // Check authentication state when the page loads
    checkAuthState();</script>
 
</body>
</html>